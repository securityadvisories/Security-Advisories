============================================================================
Blaze Information Security Advisory                         [CVE-2025-10941]
============================================================================
Title	   : Local Privilege Escalation via Insecure Directory Permissions 
             in SERVCore® Teller Installer
Product    : SERVCore® Teller
Version    : V2.14.0-RC2 [2.14.1]
Platform   : Microsoft Windows
Severity   : Medium
Date	   : 11/07/2025
Discovered : Igor Marcel (Blaze Information Security)
============================================================================

Overview
--------

A local privilege escalation vulnerability was identified in the
installation routine of SERVCore® Teller version V2.14.0-RC2 [2.14.1]. 
The issue is caused by improper permission handling of the service binary
installation directory, allowing unprivileged users to replace the service
binary with a malicious executable, which is then executed with SYSTEM
privileges upon reboot.

Affected Software
-----------------

Product:        SERVCore® Teller
Version:        V2.14.0-RC2 [2.14.1]
Installer File: SERVCoreTeller_2.0.40D.msi
Platform:	Microsoft Windows

Vulnerability Details
---------------------

During installation, the SERVCore® Teller application registers a Windows
service named "SERVCoreSmartClient", configured to start automatically with
SYSTEM privileges. The associated service binary ("nssm.exe") is placed into
the directory:

    C:\ProgramData\SERVCoreTeller\Service

However, the installer does not verify whether this target directory already
exists or reset its Access Control Lists (ACLs). Since the base path
"C:\ProgramData" allows all authenticated users to create subdirectories,
a local unprivileged user can pre-create this directory before installation.

As a result, the user retains full control over the directory after the
application is installed by an administrator.

While the installed "nssm.exe" binary has restrictive file-level permissions
(read and execute only for standard users), the user's control over the 
parent directory allows them to:

    - Rename the original service binary (e.g., to "nssm.bak")
    - Replace it with a malicious executable named "nssm.exe"

Upon the next system reboot, the Windows service is automatically started
and executes the user-controlled binary with SYSTEM privileges. This leads 
to complete local privilege escalation.

Impact
------

An unprivileged local user can execute arbitrary code with SYSTEM
privileges, resulting in:

    - Full local privilege escalation
    - Potential for persistent backdoor installation
    - System compromise

Mitigation
----------

Vendors and system administrators are advised to:

    - Ensure the installer resets or secures installation-directory ACLs
    - Prevent installation of binaries into user-writable paths
    - Restrict write access to sensitive directories like
      C:\ProgramData\SERVCoreTeller\Service

References
----------

- https://learn.microsoft.com/en-us/windows/win32/secauthz/standard-access-rights
- https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/microsoft-windows-shell-setup-folderlocations-programdata
- https://cloud.google.com/blog/topics/threat-intelligence/privileges-third-party-windows-installers

Credits
-------

Discovered by Igor Marcel of Blaze Information Security, https://www.blazeinfosec.com

============================================================================
